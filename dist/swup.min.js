!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Swup",[],e):"object"==typeof exports?exports.Swup=e():t.Swup=e()}(self,(function(){return function(){"use strict";var t={d:function(e,n){for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};t.d(e,{default:function(){return N}});const n=new WeakMap;function i(t,e,i,s){var o,a;if(!t&&!n.has(e))return!1;const r=null!==(o=n.get(e))&&void 0!==o?o:new WeakMap;if(n.set(e,r),!t&&!n.has(e))return!1;const l=null!==(a=r.get(i))&&void 0!==a?a:new Set;r.set(i,l);const c=l.has(s);return t?l.add(s):l.delete(s),c&&t}var s=function t(e,n,s,o,a){if("string"==typeof e&&(e=document.querySelectorAll(e)),"function"!=typeof e.addEventListener){const i=Array.prototype.map.call(e,(e=>t(e,n,s,o,a)));return{destroy(){for(const t of i)t.destroy()}}}const r=e instanceof Document?e.documentElement:e,l=Boolean("object"==typeof a?a.capture:a),c=t=>{const e=function(t,e){let n=t.target;if(n instanceof Text&&(n=n.parentElement),n instanceof Element&&t.currentTarget instanceof Element){const i=n.closest(e);if(i&&t.currentTarget.contains(i))return i}}(t,n);e&&(t.delegateTarget=e,o.call(r,t))};"object"==typeof a&&delete a.once;const u=JSON.stringify({selector:n,type:s,capture:l}),d={destroy(){r.removeEventListener(s,c,a),i(!1,r,o,u)}};return i(!0,r,o,u)||r.addEventListener(s,c,a),d};var o=t=>{let e=t.toString().toLowerCase().replace(/\s+/g,"-").replace(/\//g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"");return"/"===e[0]&&(e=e.splice(1)),""===e&&(e="homepage"),e};var a=t=>{window.history.pushState({url:t||window.location.href.split(window.location.hostname)[1],random:Math.random(),source:"swup"},document.getElementsByTagName("title")[0].innerText,t||window.location.href.split(window.location.hostname)[1])};const r=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return"string"!=typeof t?t:e.querySelector(t)},l=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return"string"!=typeof t?t:Array.prototype.slice.call(e.querySelectorAll(t))};var c=(t,e)=>{let n=document.createElement("html");n.innerHTML=t;let i=[];e.forEach((t=>{if(null==r(t,n))return console.warn("[swup] Container ".concat(t," not found on page.")),null;l(t).length!==l(t,n).length&&console.warn("[swup] Mismatched number of containers found on new page."),l(t).forEach(((e,s)=>{l(t,n)[s].setAttribute("data-swup",i.length),i.push(l(t,n)[s].outerHTML)}))}));const s={title:n.querySelector("title").innerText,pageClass:n.querySelector("body").className,originalContent:t,blocks:i};return n.innerHTML="",n=null,s};var u=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={url:window.location.pathname+window.location.search,method:"GET",data:null,headers:{}},i={...n,...t},s=new XMLHttpRequest;return s.onreadystatechange=function(){4===s.readyState&&(s.status,e(s))},s.open(i.method,i.url,!0),Object.keys(i.headers).forEach((t=>{s.setRequestHeader(t,i.headers[t])})),s.send(i.data),s};var d=()=>void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend?"webkitTransitionEnd":"transitionend";var h=()=>void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend?"WebkitTransition":"transition";var p=()=>window.location.pathname+window.location.search;class g{constructor(t){t instanceof Element||t instanceof SVGElement?this.link=t:(this.link=document.createElement("a"),this.link.href=t)}getPath(){let t=this.link.pathname;return"/"!==t[0]&&(t="/"+t),t}getAddress(){let t=this.link.pathname+this.link.search;return this.link.getAttribute("xlink:href")&&(t=this.link.getAttribute("xlink:href")),"/"!==t[0]&&(t="/"+t),t}getHash(){return this.link.hash}}const m=o,f=a,w=c,v=u,E=d,y=h,b=p,S=t=>new g(t).getAddress(),P=(t,e)=>{let n=0;e.forEach((e=>{null==r(e,t)?console.warn("[swup] Container ".concat(e," not found on page.")):l(e).forEach(((i,s)=>{l(e,t)[s].setAttribute("data-swup",n),n++}))}))},k=g,H=()=>{document.documentElement.className.split(" ").forEach((t=>{(new RegExp("^to-").test(t)||"is-changing"===t||"is-rendering"===t||"is-popstate"===t)&&document.documentElement.classList.remove(t)}))};var L=class{constructor(){this.pages={},this.last=null}cacheUrl(t){t.url=S(t.url),t.url in this.pages==!1&&(this.pages[t.url]=t),this.last=this.pages[t.url],this.swup.log("Cache (".concat(Object.keys(this.pages).length,")"),this.pages)}getPage(t){return t=S(t),this.pages[t]}getCurrentPage(){return this.getPage(b())}exists(t){return(t=S(t))in this.pages}empty(){this.pages={},this.last=null,this.swup.log("Cache cleared")}remove(t){delete this.pages[t]}};var T=function(t,e){let n,i=[];const s=()=>{if(this.triggerEvent("animationOutStart"),document.documentElement.classList.add("is-changing"),document.documentElement.classList.add("is-leaving"),document.documentElement.classList.add("is-animating"),e&&document.documentElement.classList.add("is-popstate"),document.documentElement.classList.add("to-"+m(t.url)),i=this.getAnimationPromises("out"),Promise.all(i).then((()=>{this.triggerEvent("animationOutDone")})),!e){let e;e=null!=this.scrollToElement?t.url+this.scrollToElement:t.url,f(e)}};this.triggerEvent("transitionStart",e),null!=t.customTransition?(this.updateTransition(window.location.pathname,t.url,t.customTransition),document.documentElement.classList.add("to-".concat(m(t.customTransition)))):this.updateTransition(window.location.pathname,t.url),!e||this.options.animateHistoryBrowsing?s():this.triggerEvent("animationSkipped"),this.cache.exists(t.url)?(n=new Promise((t=>{t()})),this.triggerEvent("pageRetrievedFromCache")):n=this.preloadPromise&&this.preloadPromise.route==t.url?this.preloadPromise:new Promise(((e,n)=>{v({...t,headers:this.options.requestHeaders},(i=>{if(500===i.status)return this.triggerEvent("serverError"),void n(t.url);{let e=this.getPageData(i);if(!(null!=e&&e.blocks.length>0))return void n(t.url);e.url=t.url,this.cache.cacheUrl(e),this.triggerEvent("pageLoaded")}e()}))})),Promise.all(i.concat([n])).then((()=>{this.renderPage(this.cache.getPage(t.url),e),this.preloadPromise=null})).catch((t=>{this.options.skipPopStateHandling=function(){return window.location=t,!0},window.history.go(-1)}))};var A=function(t,e){document.documentElement.classList.remove("is-leaving");if(!(this.getCurrentUrl()===t.url))return;const n=new k(t.responseURL).getPath();window.location.pathname!==n&&(window.history.replaceState({url:n,random:Math.random(),source:"swup"},document.title,n),this.cache.cacheUrl({...t,url:n})),e&&!this.options.animateHistoryBrowsing||document.documentElement.classList.add("is-rendering"),this.triggerEvent("willReplaceContent",e);for(let e=0;e<t.blocks.length;e++)document.body.querySelector('[data-swup="'.concat(e,'"]')).outerHTML=t.blocks[e];if(document.title=t.title,this.triggerEvent("contentReplaced",e),this.triggerEvent("pageView",e),this.options.cache||this.cache.empty(),setTimeout((()=>{e&&!this.options.animateHistoryBrowsing||(this.triggerEvent("animationInStart"),document.documentElement.classList.remove("is-animating"))}),10),!e||this.options.animateHistoryBrowsing){const t=this.getAnimationPromises("in");Promise.all(t).then((()=>{this.triggerEvent("animationInDone"),this.triggerEvent("transitionEnd",e),this.cleanupAnimationClasses()}))}else this.triggerEvent("transitionEnd",e);this.scrollToElement=null};var C=function(t,e){this._handlers[t].forEach((t=>{try{t(e)}catch(t){console.error(t)}}));const n=new CustomEvent("swup:"+t,{detail:t});document.dispatchEvent(n)};var x=function(t,e){this._handlers[t]?this._handlers[t].push(e):console.warn("Unsupported event ".concat(t,"."))};var R=function(t,e){if(null!=t)if(null!=e)if(this._handlers[t]&&this._handlers[t].filter((t=>t===e)).length){let n=this._handlers[t].filter((t=>t===e))[0],i=this._handlers[t].indexOf(n);i>-1&&this._handlers[t].splice(i,1)}else console.warn("Handler for event '".concat(t,"' no found."));else this._handlers[t]=[];else Object.keys(this._handlers).forEach((t=>{this._handlers[t]=[]}))};var _=function(t,e,n){this.transition={from:t,to:e,custom:n}};var M=t=>{return t?("#"===t.charAt(0)&&(t=t.substring(1)),t=decodeURIComponent(t),e=t,t=window.CSS&&window.CSS.escape?CSS.escape(e):e,r("#".concat(t))||r("a[name='".concat(t,"']"))):null;var e};var U=function(){const t=this.options.animationSelector,e="".concat(y(),"Duration"),n=[],i=l(t,document.body);return i.length?(i.forEach((i=>{const s=window.getComputedStyle(i)[e];if(!s||"0s"==s)return console.warn("[swup] No CSS transition duration defined for element of selector ".concat(t)),void n.push(Promise.resolve());const o=new Promise((t=>{i.addEventListener(E(),(e=>{i==e.target&&t()}))}));n.push(o)})),n):(console.warn("[swup] No animated elements found by selector ".concat(t)),[Promise.resolve()])};var O=function(t){const e=t.responseText;let n=w(e,this.options.containers);return n?(n.responseURL=t.responseURL?t.responseURL:window.location.href,n):(console.warn("[swup] Received page is invalid."),null)};const j=function(t){if(t.isSwupPlugin)return this.plugins.push(t),t.swup=this,"function"==typeof t._beforeMount&&t._beforeMount(),t.mount(),this.plugins;console.warn("Not swup plugin instance ".concat(t,"."))},q=function(t){let e;if(e="string"==typeof t?this.plugins.find((e=>t===e.name)):t,!e)return void console.warn("No such plugin.");e.unmount(),"function"==typeof e._afterUnmount&&e._afterUnmount();const n=this.plugins.indexOf(e);return this.plugins.splice(n,1),this.plugins},D=function(t){return this.plugins.find((e=>t===e.name))};class N{constructor(t){const e={...{animateHistoryBrowsing:!1,animationSelector:'[class*="transition-"]',linkSelector:'a[href^="'.concat(window.location.origin,'"]:not([data-no-swup]), a[href^="/"]:not([data-no-swup]), a[href^="#"]:not([data-no-swup])'),cache:!0,containers:["#swup"],requestHeaders:{"X-Requested-With":"swup",Accept:"text/html, application/xhtml+xml"},plugins:[],skipPopStateHandling:function(t){return!(t.state&&"swup"===t.state.source)}},...t};this._handlers={animationInDone:[],animationInStart:[],animationOutDone:[],animationOutStart:[],animationSkipped:[],clickLink:[],contentReplaced:[],disabled:[],enabled:[],openPageInNewTab:[],pageLoaded:[],pageRetrievedFromCache:[],pageView:[],popState:[],samePage:[],samePageWithHash:[],serverError:[],transitionStart:[],transitionEnd:[],willReplaceContent:[]},this.scrollToElement=null,this.preloadPromise=null,this.options=e,this.plugins=[],this.transition={},this.delegatedListeners={},this.boundPopStateHandler=this.popStateHandler.bind(this),this.cache=new L,this.cache.swup=this,this.loadPage=T,this.renderPage=A,this.triggerEvent=C,this.on=x,this.off=R,this.updateTransition=_,this.getAnimationPromises=U,this.getPageData=O,this.getAnchorElement=M,this.log=()=>{},this.use=j,this.unuse=q,this.findPlugin=D,this.getCurrentUrl=b,this.cleanupAnimationClasses=H,this.enable()}enable(){if("undefined"!=typeof Promise){if(this.delegatedListeners.click=s(document,this.options.linkSelector,"click",this.linkClickHandler.bind(this)),window.addEventListener("popstate",this.boundPopStateHandler),this.options.cache){const t=w(document.documentElement.outerHTML,this.options.containers);t.url=t.responseURL=b(),this.cache.cacheUrl(t)}P(document.documentElement,this.options.containers),this.options.plugins.forEach((t=>{this.use(t)})),window.history.replaceState(Object.assign({},window.history.state,{url:window.location.href,random:Math.random(),source:"swup"}),document.title,window.location.href),this.triggerEvent("enabled"),document.documentElement.classList.add("swup-enabled"),this.triggerEvent("pageView")}else console.warn("Promise is not supported")}destroy(){this.delegatedListeners.click.destroy(),window.removeEventListener("popstate",this.boundPopStateHandler),this.cache.empty(),this.options.plugins.forEach((t=>{this.unuse(t)})),l("[data-swup]").forEach((t=>{t.removeAttribute("data-swup")})),this.off(),this.triggerEvent("disabled"),document.documentElement.classList.remove("swup-enabled")}linkClickHandler(t){if(t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)this.triggerEvent("openPageInNewTab",t);else if(0===t.button){this.triggerEvent("clickLink",t),t.preventDefault();const e=new k(t.delegateTarget);if(e.getAddress()==b()||""==e.getAddress())if(""!=e.getHash()){this.triggerEvent("samePageWithHash",t);null!=M(e.getHash())?history.replaceState({url:e.getAddress()+e.getHash(),random:Math.random(),source:"swup"},document.title,e.getAddress()+e.getHash()):console.warn("Element for offset not found (".concat(e.getHash(),")"))}else this.triggerEvent("samePage",t);else{""!=e.getHash()&&(this.scrollToElement=e.getHash());let n=t.delegateTarget.getAttribute("data-swup-transition");this.loadPage({url:e.getAddress(),customTransition:n},!1)}}}popStateHandler(t){if(this.options.skipPopStateHandling(t))return;const e=new k(t.state?t.state.url:window.location.pathname);""!==e.getHash()?this.scrollToElement=e.getHash():t.preventDefault(),this.triggerEvent("popState",t),this.options.animateHistoryBrowsing||(document.documentElement.classList.remove("is-animating"),H()),this.loadPage({url:e.getAddress()},t)}}return e=e.default}()}));