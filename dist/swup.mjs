var t={d:(e,n)=>{for(var s in n)t.o(n,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:n[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{Z:()=>R});const n=new WeakMap;function s(t,e,s,i){var o,a;if(!t&&!n.has(e))return!1;const r=null!==(o=n.get(e))&&void 0!==o?o:new WeakMap;if(n.set(e,r),!t&&!n.has(e))return!1;const l=null!==(a=r.get(s))&&void 0!==a?a:new Set;r.set(s,l);const c=l.has(i);return t?l.add(i):l.delete(i),c&&t}const i=function t(e,n,i,o,a){if("string"==typeof e&&(e=document.querySelectorAll(e)),"function"!=typeof e.addEventListener){const s=Array.prototype.map.call(e,(e=>t(e,n,i,o,a)));return{destroy(){for(const t of s)t.destroy()}}}const r=e instanceof Document?e.documentElement:e,l=Boolean("object"==typeof a?a.capture:a),c=t=>{const e=function(t,e){let n=t.target;if(n instanceof Text&&(n=n.parentElement),n instanceof Element&&t.currentTarget instanceof Element){const s=n.closest(e);if(s&&t.currentTarget.contains(s))return s}}(t,n);e&&(t.delegateTarget=e,o.call(r,t))};"object"==typeof a&&delete a.once;const u=JSON.stringify({selector:n,type:i,capture:l}),h={destroy(){r.removeEventListener(i,c,a),s(!1,r,o,u)}};return s(!0,r,o,u)||r.addEventListener(i,c,a),h},o=(t,e=document)=>"string"!=typeof t?t:e.querySelector(t),a=(t,e=document)=>"string"!=typeof t?t:Array.prototype.slice.call(e.querySelectorAll(t));class r{constructor(t){t instanceof Element||t instanceof SVGElement?this.link=t:(this.link=document.createElement("a"),this.link.href=t)}getPath(){let t=this.link.pathname;return"/"!==t[0]&&(t="/"+t),t}getAddress(){let t=this.link.pathname+this.link.search;return this.link.getAttribute("xlink:href")&&(t=this.link.getAttribute("xlink:href")),"/"!==t[0]&&(t="/"+t),t}getHash(){return this.link.hash}}const l=t=>{let e=t.toString().toLowerCase().replace(/\s+/g,"-").replace(/\//g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"");return"/"===e[0]&&(e=e.splice(1)),""===e&&(e="homepage"),e},c=t=>{window.history.pushState({url:t||window.location.href.split(window.location.hostname)[1],random:Math.random(),source:"swup"},document.getElementsByTagName("title")[0].innerText,t||window.location.href.split(window.location.hostname)[1])},u=(t,e)=>{let n=document.createElement("html");n.innerHTML=t;let s=[];e.forEach((t=>{if(null==o(t,n))return console.warn(`[swup] Container ${t} not found on page.`),null;a(t).length!==a(t,n).length&&console.warn("[swup] Mismatched number of containers found on new page."),a(t).forEach(((e,i)=>{a(t,n)[i].setAttribute("data-swup",s.length),s.push(a(t,n)[i].outerHTML)}))}));const i={title:n.querySelector("title").innerText,pageClass:n.querySelector("body").className,originalContent:t,blocks:s};return n.innerHTML="",n=null,i},h=(t,e=!1)=>{let n={url:window.location.pathname+window.location.search,method:"GET",data:null,headers:{},...t},s=new XMLHttpRequest;return s.onreadystatechange=function(){4===s.readyState&&(s.status,e(s))},s.open(n.method,n.url,!0),Object.keys(n.headers).forEach((t=>{s.setRequestHeader(t,n.headers[t])})),s.send(n.data),s},d=()=>void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend?"webkitTransitionEnd":"transitionend",p=()=>void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend?"WebkitTransition":"transition",g=()=>window.location.pathname+window.location.search,m=t=>new r(t).getAddress(),w=r,f=()=>{document.documentElement.className.split(" ").forEach((t=>{(new RegExp("^to-").test(t)||"is-changing"===t||"is-rendering"===t||"is-popstate"===t)&&document.documentElement.classList.remove(t)}))},E=function(t,e){let n,s=[];this.triggerEvent("transitionStart",e),null!=t.customTransition?(this.updateTransition(window.location.pathname,t.url,t.customTransition),document.documentElement.classList.add(`to-${l(t.customTransition)}`)):this.updateTransition(window.location.pathname,t.url),!e||this.options.animateHistoryBrowsing?(()=>{if(this.triggerEvent("animationOutStart"),document.documentElement.classList.add("is-changing"),document.documentElement.classList.add("is-leaving"),document.documentElement.classList.add("is-animating"),e&&document.documentElement.classList.add("is-popstate"),document.documentElement.classList.add("to-"+l(t.url)),s=this.getAnimationPromises("out"),Promise.all(s).then((()=>{this.triggerEvent("animationOutDone")})),!e){let e;e=null!=this.scrollToElement?t.url+this.scrollToElement:t.url,c(e)}})():this.triggerEvent("animationSkipped"),this.cache.exists(t.url)?(n=new Promise((t=>{t()})),this.triggerEvent("pageRetrievedFromCache")):n=this.preloadPromise&&this.preloadPromise.route==t.url?this.preloadPromise:new Promise(((e,n)=>{h({...t,headers:this.options.requestHeaders},(s=>{if(500===s.status)return this.triggerEvent("serverError"),void n(t.url);{let e=this.getPageData(s);if(!(null!=e&&e.blocks.length>0))return void n(t.url);e.url=t.url,this.cache.cacheUrl(e),this.triggerEvent("pageLoaded")}e()}))})),Promise.all(s.concat([n])).then((()=>{this.renderPage(this.cache.getPage(t.url),e),this.preloadPromise=null})).catch((t=>{this.options.skipPopStateHandling=function(){return window.location=t,!0},window.history.go(-1)}))},v=function(t,e){if(document.documentElement.classList.remove("is-leaving"),this.getCurrentUrl()!==t.url)return;const n=new w(t.responseURL).getPath();window.location.pathname!==n&&(window.history.replaceState({url:n,random:Math.random(),source:"swup"},document.title,n),this.cache.cacheUrl({...t,url:n})),e&&!this.options.animateHistoryBrowsing||document.documentElement.classList.add("is-rendering"),this.triggerEvent("willReplaceContent",e);for(let e=0;e<t.blocks.length;e++)document.body.querySelector(`[data-swup="${e}"]`).outerHTML=t.blocks[e];if(document.title=t.title,this.triggerEvent("contentReplaced",e),this.triggerEvent("pageView",e),this.options.cache||this.cache.empty(),setTimeout((()=>{e&&!this.options.animateHistoryBrowsing||(this.triggerEvent("animationInStart"),document.documentElement.classList.remove("is-animating"))}),10),!e||this.options.animateHistoryBrowsing){const t=this.getAnimationPromises("in");Promise.all(t).then((()=>{this.triggerEvent("animationInDone"),this.triggerEvent("transitionEnd",e),this.cleanupAnimationClasses()}))}else this.triggerEvent("transitionEnd",e);this.scrollToElement=null},y=function(t,e){this._handlers[t].forEach((t=>{try{t(e)}catch(t){console.error(t)}}));const n=new CustomEvent("swup:"+t,{detail:t});document.dispatchEvent(n)},b=function(t,e){this._handlers[t]?this._handlers[t].push(e):console.warn(`Unsupported event ${t}.`)},P=function(t,e){if(null!=t)if(null!=e)if(this._handlers[t]&&this._handlers[t].filter((t=>t===e)).length){let n=this._handlers[t].filter((t=>t===e))[0],s=this._handlers[t].indexOf(n);s>-1&&this._handlers[t].splice(s,1)}else console.warn(`Handler for event '${t}' no found.`);else this._handlers[t]=[];else Object.keys(this._handlers).forEach((t=>{this._handlers[t]=[]}))},S=function(t,e,n){this.transition={from:t,to:e,custom:n}},k=t=>{return t?("#"===t.charAt(0)&&(t=t.substring(1)),e=t=decodeURIComponent(t),t=window.CSS&&window.CSS.escape?CSS.escape(e):e,o(`#${t}`)||o(`a[name='${t}']`)):null;var e},H=function(){const t=this.options.animationSelector,e=`${p()}Duration`,n=[],s=a(t,document.body);return s.length?(s.forEach((s=>{const i=window.getComputedStyle(s)[e];if(!i||"0s"==i)return console.warn(`[swup] No CSS transition duration defined for element of selector ${t}`),void n.push(Promise.resolve());const o=new Promise((t=>{s.addEventListener(d(),(e=>{s==e.target&&t()}))}));n.push(o)})),n):(console.warn(`[swup] No animated elements found by selector ${t}`),[Promise.resolve()])},L=function(t){const e=t.responseText;let n=u(e,this.options.containers);return n?(n.responseURL=t.responseURL?t.responseURL:window.location.href,n):(console.warn("[swup] Received page is invalid."),null)},T=function(t){if(t.isSwupPlugin)return this.plugins.push(t),t.swup=this,"function"==typeof t._beforeMount&&t._beforeMount(),t.mount(),this.plugins;console.warn(`Not swup plugin instance ${t}.`)},A=function(t){let e;if(e="string"==typeof t?this.plugins.find((e=>t===e.name)):t,!e)return void console.warn("No such plugin.");e.unmount(),"function"==typeof e._afterUnmount&&e._afterUnmount();const n=this.plugins.indexOf(e);return this.plugins.splice(n,1),this.plugins},C=function(t){return this.plugins.find((e=>t===e.name))};class R{constructor(t){const e={animateHistoryBrowsing:!1,animationSelector:'[class*="transition-"]',linkSelector:`a[href^="${window.location.origin}"]:not([data-no-swup]), a[href^="/"]:not([data-no-swup]), a[href^="#"]:not([data-no-swup])`,cache:!0,containers:["#swup"],requestHeaders:{"X-Requested-With":"swup",Accept:"text/html, application/xhtml+xml"},plugins:[],skipPopStateHandling:function(t){return!(t.state&&"swup"===t.state.source)},...t};this._handlers={animationInDone:[],animationInStart:[],animationOutDone:[],animationOutStart:[],animationSkipped:[],clickLink:[],contentReplaced:[],disabled:[],enabled:[],openPageInNewTab:[],pageLoaded:[],pageRetrievedFromCache:[],pageView:[],popState:[],samePage:[],samePageWithHash:[],serverError:[],transitionStart:[],transitionEnd:[],willReplaceContent:[]},this.scrollToElement=null,this.preloadPromise=null,this.options=e,this.plugins=[],this.transition={},this.delegatedListeners={},this.boundPopStateHandler=this.popStateHandler.bind(this),this.cache=new class{constructor(){this.pages={},this.last=null}cacheUrl(t){t.url=m(t.url),t.url in this.pages==0&&(this.pages[t.url]=t),this.last=this.pages[t.url],this.swup.log(`Cache (${Object.keys(this.pages).length})`,this.pages)}getPage(t){return t=m(t),this.pages[t]}getCurrentPage(){return this.getPage(g())}exists(t){return(t=m(t))in this.pages}empty(){this.pages={},this.last=null,this.swup.log("Cache cleared")}remove(t){delete this.pages[t]}},this.cache.swup=this,this.loadPage=E,this.renderPage=v,this.triggerEvent=y,this.on=b,this.off=P,this.updateTransition=S,this.getAnimationPromises=H,this.getPageData=L,this.getAnchorElement=k,this.log=()=>{},this.use=T,this.unuse=A,this.findPlugin=C,this.getCurrentUrl=g,this.cleanupAnimationClasses=f,this.enable()}enable(){if("undefined"!=typeof Promise){if(this.delegatedListeners.click=i(document,this.options.linkSelector,"click",this.linkClickHandler.bind(this)),window.addEventListener("popstate",this.boundPopStateHandler),this.options.cache){const t=u(document.documentElement.outerHTML,this.options.containers);t.url=t.responseURL=g(),this.cache.cacheUrl(t)}((t,e)=>{let n=0;e.forEach((e=>{null==o(e,t)?console.warn(`[swup] Container ${e} not found on page.`):a(e).forEach(((s,i)=>{a(e,t)[i].setAttribute("data-swup",n),n++}))}))})(document.documentElement,this.options.containers),this.options.plugins.forEach((t=>{this.use(t)})),window.history.replaceState(Object.assign({},window.history.state,{url:window.location.href,random:Math.random(),source:"swup"}),document.title,window.location.href),this.triggerEvent("enabled"),document.documentElement.classList.add("swup-enabled"),this.triggerEvent("pageView")}else console.warn("Promise is not supported")}destroy(){this.delegatedListeners.click.destroy(),window.removeEventListener("popstate",this.boundPopStateHandler),this.cache.empty(),this.options.plugins.forEach((t=>{this.unuse(t)})),a("[data-swup]").forEach((t=>{t.removeAttribute("data-swup")})),this.off(),this.triggerEvent("disabled"),document.documentElement.classList.remove("swup-enabled")}linkClickHandler(t){if(t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)this.triggerEvent("openPageInNewTab",t);else if(0===t.button){this.triggerEvent("clickLink",t),t.preventDefault();const e=new w(t.delegateTarget);if(e.getAddress()==g()||""==e.getAddress())""!=e.getHash()?(this.triggerEvent("samePageWithHash",t),null!=k(e.getHash())?history.replaceState({url:e.getAddress()+e.getHash(),random:Math.random(),source:"swup"},document.title,e.getAddress()+e.getHash()):console.warn(`Element for offset not found (${e.getHash()})`)):this.triggerEvent("samePage",t);else{""!=e.getHash()&&(this.scrollToElement=e.getHash());let n=t.delegateTarget.getAttribute("data-swup-transition");this.loadPage({url:e.getAddress(),customTransition:n},!1)}}}popStateHandler(t){if(this.options.skipPopStateHandling(t))return;const e=new w(t.state?t.state.url:window.location.pathname);""!==e.getHash()?this.scrollToElement=e.getHash():t.preventDefault(),this.triggerEvent("popState",t),this.options.animateHistoryBrowsing||(document.documentElement.classList.remove("is-animating"),f()),this.loadPage({url:e.getAddress()},t)}}var $=e.Z;export{$ as default};